# ğŸ§¾ ç”¨æˆ·ç³»ç»Ÿ API æ–‡æ¡£ï¼ˆåŸºäº GORM User æ¨¡å‹ï¼‰

> æ¥å£å‰ç¼€ï¼š`/api/v1/user`  
> ç»Ÿä¸€å“åº”ç»“æ„å¦‚ä¸‹ï¼š

```json
{
  "code": 0,
  "msg": "æˆåŠŸ",
  "data": {}
}
```

---

## ğŸ” 1. ç”¨æˆ·æ³¨å†Œ

- **æ¥å£**ï¼š`POST /api/v1/user/register`
- **æè¿°**ï¼šæ³¨å†Œæ–°ç”¨æˆ·
- **è¯·æ±‚å‚æ•°**ï¼š

```json
{
  "username": "xiaolin2025ï¼ˆå”¯ä¸€å€¼ï¼‰",
  "email": "user@example.com",
  "password": "123456"
}
```

- **å“åº”æ•°æ®**ï¼ˆ`HTTPResult{Data: User}`ï¼‰ï¼š

```json
{
  "code": 200,
  "msg": "æ³¨å†ŒæˆåŠŸ",
  "data": {
    "id": 1,
    "username": "xiaolin2025ï¼ˆå”¯ä¸€å€¼ï¼‰",
    "nickname": "æ–°ç”¨æˆ·",
    "email": "user@example.com",
    "failed_attempts": 0,
    "last_login_at": null,
    "last_failed_attempt": null,
    "perms": 0,
    "status": 1,
    "created_at": "2025-06-20T12:00:00Z",
    "updated_at": "2025-06-20T12:00:00Z",
    "ip_address": "127.0.0.1"
  }
}
```

---

## ğŸ”‘ 2. ç”¨æˆ·ç™»å½•

- **æ¥å£**ï¼š`POST /api/v1/user/login`
- **æè¿°**ï¼šç”¨æˆ·ç™»å½•å¹¶è¿”å› JWT Token
- **è¯·æ±‚å‚æ•°**ï¼š

```json
{
  "email": "user@example.com", 
  "password": "123456"
}
```

```json
{
  "username": "123456",
  "password": "123456"
}
```

- **å“åº”æ•°æ®**ï¼ˆ`HTTPResult{Data: map[string]string}`ï¼‰ï¼š

```json
{
  "code": 200,
  "msg": "ç™»å½•æˆåŠŸ",
  "data": {
    "access_token": "jwt-token-string",
    "refresh_token": "refresh-token-string"
  }
}
```

---

## ğŸšª 3. ç”¨æˆ·ç™»å‡º

- **æ¥å£**ï¼š`POST /api/v1/user/logout`
- **æè¿°**ï¼šæ³¨é”€å½“å‰ç™»å½•
- **è¯·æ±‚å¤´**ï¼š

```
Authorization: Bearer <access_token>
```

- **å“åº”**ï¼š

```json
{
  "code": 200,
  "msg": "é€€å‡ºæˆåŠŸ", 
  "data": null
}
```

---

## ğŸ‘¤ 4. è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯

- **æ¥å£**ï¼š`GET /api/v1/user/me`
- **æè¿°**ï¼šè·å–å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯
- **è¯·æ±‚å¤´**ï¼š

```
Authorization: Bearer <access_token>
```

- **å“åº”æ•°æ®**ï¼ˆ`HTTPResult{Data: User}`ï¼‰ï¼š

```json
{
  "code": 200,
  "msg": "æŸ¥è¯¢æˆåŠŸ",
  "data": {
    "id": 1,
    "username": "exampleuser",
    "nickname": "æ–°ç”¨æˆ·",
    "email": "user@example.com",
    "failed_attempts": 0,
    "last_login_at": "2025-06-20T13:00:00Z",
    "last_failed_attempt": null,
    "perms": 4,
    "status": 1,
    "created_at": "2025-06-20T12:00:00Z",
    "updated_at": "2025-06-20T13:00:00Z",
    "ip_address": "127.0.0.1"
  }
}
```

---

## âœï¸ 5. æ›´æ–°ç”¨æˆ·ä¿¡æ¯

- **æ¥å£**ï¼š`PUT /api/v1/user/update`
- **æè¿°**ï¼šä¿®æ”¹æ˜µç§°å’Œå¤´åƒç­‰ä¿¡æ¯
- **è¯·æ±‚å¤´**ï¼š

```
Authorization: Bearer <access_token>
```

- **è¯·æ±‚å‚æ•°**ï¼š

```json
{
  "nickname": "æˆ‘æ˜¯qwq",
  "ip_address": "192.168.0.1"
}
```

---

## ğŸ”‘ 6. ä¿®æ”¹å¯†ç 

- **æ¥å£**ï¼š`PUT /api/v1/user/password`
- **æè¿°**ï¼šä¿®æ”¹ç™»å½•å¯†ç 
- **è¯·æ±‚å‚æ•°**ï¼š

```json
{
  "old_password": "123456",
  "new_password": "654321"
}
```

---

## ğŸ”„ 7. åˆ·æ–° Token

- **æ¥å£**ï¼š`POST /api/v1/user/token/refresh`
- **æè¿°**ï¼šé€šè¿‡ refresh_token åˆ·æ–° access_token
- **è¯·æ±‚å‚æ•°**ï¼š

```json
{
  "refresh_token": "refresh-token-string"
}
```

- **å“åº”æ•°æ®**ï¼š

```json
{
  "code": 0,
  "msg": "åˆ·æ–°æˆåŠŸ",
  "data": {
    "access_token": "new-jwt-token"
  }
}
```

---

## ğŸ” 8. ç”¨æˆ·åæˆ–é‚®ç®±æ˜¯å¦å­˜åœ¨

- **æ¥å£**ï¼š`GET /api/v1/user/check`
- **æè¿°**ï¼šåˆ¤æ–­ç”¨æˆ·åæˆ–é‚®ç®±æ˜¯å¦å·²æ³¨å†Œ
- **è¯·æ±‚å‚æ•°**ï¼š

```
/api/v1/user/check?email=user@example.com
```

- **å“åº”æ•°æ®**ï¼š

```json
{
  "code": 0,
  "msg": "æœªè¢«å ç”¨"
}
```

---

## ğŸ§  9. æ‰¾å›å¯†ç ï¼ˆéªŒè¯ç ï¼‰

- **æ¥å£**ï¼š`POST /api/v1/user/password/forgot`
- **æè¿°**ï¼šå‘é€é‡ç½®å¯†ç éªŒè¯ç 
- **è¯·æ±‚å‚æ•°**ï¼š

```json
{
  "email": "user@example.com"
}
```

---

## ğŸ” 10. é‡ç½®å¯†ç 

- **æ¥å£**ï¼š`POST /api/v1/user/password/reset`
- **æè¿°**ï¼šæ ¹æ®éªŒè¯ç é‡ç½®å¯†ç 
- **è¯·æ±‚å‚æ•°**ï¼š

```json
{
  "email": "user@example.com",
  "code": "123456",
  "new_password": "newpassword"
}
```

---

## ğŸš¨ 11. ç™»å½•å†å²è®°å½•ï¼ˆå¯é€‰ï¼‰

- **æ¥å£**ï¼š`GET /api/v1/user/login/history`
- **æè¿°**ï¼šè·å–æœ€è¿‘ç™»å½•è®°å½•
- **å“åº”æ•°æ®**ï¼ˆç¤ºä¾‹ï¼‰ï¼š

```json
{
  "code": 0,
  "msg": "æŸ¥è¯¢æˆåŠŸ",
  "data": [
    {
      "ip": "127.0.0.1",
      "device": "Windows",
      "login_time": "2025-06-20T12:00:00Z"
    }
  ]
}
```

---

## ğŸ“Œ ç»Ÿä¸€å“åº”ç»“æ„è¯´æ˜

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| code | int | çŠ¶æ€ç ï¼Œ0 è¡¨ç¤ºæˆåŠŸ |
| msg  | string | æç¤ºä¿¡æ¯ |
| data | any | å…·ä½“è¿”å›æ•°æ®ç»“æ„ä½“ |

```json
{
  "code": 4001,
  "msg": "é‚®ç®±å·²å­˜åœ¨",
  "data": null
}
```

---
